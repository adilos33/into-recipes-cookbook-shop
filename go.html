<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Opening…</title>
<style>
  body{margin:0;background:#0b0b0b;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
       min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
  .card{max-width:640px;width:100%;background:#141414;border:1px solid #2a2a2a;border-radius:14px;padding:18px}
  h1{font-size:20px;margin:0 0 8px}
  p{color:#c7c7c7;margin:0 0 12px}
  .btn{display:block;text-align:center;padding:12px 14px;border-radius:12px;border:1px solid #2a2a2a;
       background:#1b1b1b;color:#fff;text-decoration:none;font-weight:700;margin-top:10px}
  .primary{background:#ff2d55;border:none}
  small{color:#9aa0a6}
  code{background:#111;padding:2px 6px;border-radius:6px}
</style>
<body>
  <div class="card">
    <h1>Opening in TikTok…</h1>
    <p>If it doesn’t open automatically, use the options below.</p>

    <a id="open1" class="btn primary" rel="nofollow sponsored noopener">Open in TikTok Shop</a>
    <a id="open2" class="btn" target="_blank" rel="nofollow sponsored noopener">Open in external browser</a>
    <a id="copy" class="btn" href="#">Copy link</a>

    <p id="tt-tip" style="display:none"><small>
      Tip for the TikTok in-app browser: tap <b>•••</b> then choose <b>Open in external browser</b>.
    </small></p>
  </div>

<script>
  // read ?u=<encoded URL>
  const params = new URLSearchParams(location.search);
  const url = params.get('u') ? decodeURIComponent(params.get('u')) : '';

  // set buttons
  const open1 = document.getElementById('open1');
  const open2 = document.getElementById('open2');
  const copy  = document.getElementById('copy');
  if(url){ open1.href = url; open2.href = url; }

  // detect TikTok webview
  const ua = navigator.userAgent.toLowerCase();
  const isTikTok = ua.includes('tiktok') || ua.includes('musical.ly') || ua.includes('ttwebview');

  // show tip inside TikTok webview
  if(isTikTok){ document.getElementById('tt-tip').style.display = 'block'; }

  // try auto-redirect after short delay
  if(url){
    setTimeout(() => {
      // open in same tab first (works in many cases)
      window.location.href = url;
      // safety second attempt (new tab)
      setTimeout(() => { window.open(url, '_blank'); }, 800);
    }, 700);
  }

  // copy button
  copy.addEventListener('click', (e) => {
    e.preventDefault();
    if(!url) return;
    navigator.clipboard.writeText(url).then(()=>{
      copy.textContent = 'Copied ✓';
      setTimeout(()=>copy.textContent='Copy link', 1500);
    });
  });
</script>
</body>
</html>
